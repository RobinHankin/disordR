<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Non-Ordered Vectors • disordR</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Non-Ordered Vectors">
<meta name="description" content="Functionality for manipulating values of associative maps. The package is a dependency for mvp-type packages that use the STL map class: it traps plausible idiom that is ill-defined (implementation-specific) and returns an informative error, rather than returning a possibly incorrect result. To cite the package in publications please use Hankin (2022) &lt;doi:10.48550/ARXIV.2210.03856&gt;.">
<meta property="og:description" content="Functionality for manipulating values of associative maps. The package is a dependency for mvp-type packages that use the STL map class: it traps plausible idiom that is ill-defined (implementation-specific) and returns an informative error, rather than returning a possibly incorrect result. To cite the package in publications please use Hankin (2022) &lt;doi:10.48550/ARXIV.2210.03856&gt;.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">disordR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9-8-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/disordR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/disindex.html">Disordered indices with the `disordR` package: an introduction to class `disindex`</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/RobinHankin/disordR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="the-disordr-package">The disordR package<a class="anchor" aria-label="anchor" href="#the-disordr-package"></a>
</h1></div>
<!-- README.md is generated from README.Rmd. Please edit that file -->
<p><img src="reference/figures/disordR.png" width="150" align="right"></p>
<!-- badges: start -->

</div>
<div class="section level1">
<h1 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h1>
<p>Ordinary R vectors are unsuitable for working with values of associative maps because elements of an R vector may be accessed by reference to their location in the vector, but associative maps are stored in arbitrary order. However, when associating keys with values one needs both parts to be in 1-1 correspondence, so one cannot dispense with the order entirely. The disordR package includes a single <code>S4</code> class, <code>disord</code>. This class allows one to perform only those operations appropriate for manipulating values (or keys) of associative maps.</p>
<p>A useful heuristic is that one is only allowed to access or modify a disord object using a python list comprehension. The idea is to prevent “illegal” operations on values (or keys) of associative maps, whose order is undefined or at best implementation-specific, while allowing sensible operations.</p>
</div>
<div class="section level1">
<h1 id="the-disord-package-in-use">The <code>disord</code> package in use<a class="anchor" aria-label="anchor" href="#the-disord-package-in-use"></a>
</h1>
<p>I will illustrate the package by a few examples of legal and illegal code. First create a simple <code>disord</code> object:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rdis.html">rdis</a></span><span class="op">(</span><span class="op">)</span>    <span class="co"># a random disord object</span></span>
<span><span class="va">a</span></span>
<span><span class="co">#&gt; A disord object with hash 5b7279f3c05d00cf1e8f999a755151e0451c56ec and elements</span></span>
<span><span class="co">#&gt; [1] 9 4 7 1 2 6 3 8 5</span></span>
<span><span class="co">#&gt; (in some order)</span></span></code></pre></div>
<p>We may perform various operations on this object:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span><span class="op">+</span><span class="fl">4</span></span>
<span><span class="co">#&gt; A disord object with hash 5b7279f3c05d00cf1e8f999a755151e0451c56ec and elements</span></span>
<span><span class="co">#&gt; [1] 13  8 11  5  6 10  7 12  9</span></span>
<span><span class="co">#&gt; (in some order)</span></span>
<span><span class="va">a</span> <span class="op">&gt;</span> <span class="fl">5</span></span>
<span><span class="co">#&gt; A disord object with hash 5b7279f3c05d00cf1e8f999a755151e0451c56ec and elements</span></span>
<span><span class="co">#&gt; [1]  TRUE FALSE  TRUE FALSE FALSE  TRUE FALSE  TRUE FALSE</span></span>
<span><span class="co">#&gt; (in some order)</span></span>
<span><span class="va">a</span><span class="op">[</span><span class="va">a</span><span class="op">&lt;</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="co">#&gt; A disord object with hash 1cb2c1cb8b5cb3c58e69ffcc5f88340cbdc6abbd and elements</span></span>
<span><span class="co">#&gt; [1] 4 1 2 3 5</span></span>
<span><span class="co">#&gt; (in some order)</span></span></code></pre></div>
<p>with no difficulty. But if we try to find elements of <code>a</code> with a particular offset or offsets, the system returns an error:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="co">#&gt; Error in .local(x, i, j = j, ..., drop): if using a regular index to extract, must extract each element once and once only (or none of them)</span></span>
<span><span class="va">a</span><span class="op">[</span><span class="fu"><a href="reference/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; Error in .local(x, i, j = j, ..., drop): if using a regular index to extract, must extract each element once and once only (or none of them)</span></span></code></pre></div>
<p>This is because the elements of <code>a</code> are stored in an implementation-specific order and there is no such thing as the “first” element. We may manipulate elements of <code>a</code> by reference to their values but not by their position in the vector:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span><span class="op">[</span><span class="va">a</span><span class="op">&lt;</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span>  <span class="co"># round small elements down</span></span>
<span><span class="va">a</span></span>
<span><span class="co">#&gt; A disord object with hash 5b7279f3c05d00cf1e8f999a755151e0451c56ec and elements</span></span>
<span><span class="co">#&gt; [1] 9 4 7 0 0 6 3 8 5</span></span>
<span><span class="co">#&gt; (in some order)</span></span></code></pre></div>
<p>Replacement methods can access subsets where this makes sense:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">disord</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; A disord object with hash 65e11d78de79b7f584068ad856749e3748cb837c and elements</span></span>
<span><span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span></span>
<span><span class="co">#&gt; (in some order)</span></span>
<span><span class="va">x</span><span class="op">[</span><span class="va">x</span><span class="op">&lt;</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">[</span><span class="va">x</span><span class="op">&lt;</span><span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="fl">100</span></span>
<span><span class="va">x</span></span>
<span><span class="co">#&gt; A disord object with hash 65e11d78de79b7f584068ad856749e3748cb837c and elements</span></span>
<span><span class="co">#&gt;  [1] 101 102   3   4   5   6   7   8   9  10</span></span>
<span><span class="co">#&gt; (in some order)</span></span></code></pre></div>
<div class="section level2">
<h2 id="two-distinct-disord-objects">Two distinct <code>disord</code> objects<a class="anchor" aria-label="anchor" href="#two-distinct-disord-objects"></a>
</h2>
<p>If we create another <code>disord</code> object, <code>b</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rdis.html">rdis</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">b</span></span>
<span><span class="co">#&gt; A disord object with hash 488e1c6f4e2c062379d47b5511730a9785661318 and elements</span></span>
<span><span class="co">#&gt; [1] 2 3 8 1 5 6 9 7 4</span></span>
<span><span class="co">#&gt; (in some order)</span></span></code></pre></div>
<p>Then <code>a</code> and <code>b</code> have the same length, but adding them vectorially is forbidden because the order of their elements is implementation-specific:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span><span class="op">+</span><span class="va">b</span></span>
<span><span class="co">#&gt; disordR discipline error in:</span></span>
<span><span class="co">#&gt; a + b</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; hash codes 5b7279f3c05d00cf1e8f999a755151e0451c56ec and 488e1c6f4e2c062379d47b5511730a9785661318 do not match</span></span>
<span><span class="co">#&gt; Error in check_matching_hash(e1, e2, match.call()): stopping</span></span></code></pre></div>
<p>Also, replacement methods that access cross-referenced locations are forbidden:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span><span class="op">[</span><span class="va">b</span> <span class="op">&lt;</span> <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="co">#&gt; disordR discipline error in:</span></span>
<span><span class="co">#&gt; .local(x = x, i = i, j = j, value = value)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; hash codes 5b7279f3c05d00cf1e8f999a755151e0451c56ec and 488e1c6f4e2c062379d47b5511730a9785661318 do not match</span></span>
<span><span class="co">#&gt; Error in check_matching_hash(x, i, match.call()): stopping</span></span></code></pre></div>
<p>(observe carefully that <code>a[b&lt;14] &lt;- 5</code> is legal). However, sometimes one knows that two disord objects have the <em>same</em> ordering (perhaps <code>a</code> is the key, and <code>b</code> the value, of an associative array). In this case one may cross-reference them provided that the hash codes of the two objects agree:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/rdis.html">rdis</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">disord</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span>,<span class="fu"><a href="reference/disord.html">hash</a></span><span class="op">(</span><span class="va">a</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">a</span></span>
<span><span class="co">#&gt; A disord object with hash 909ab9cb9afebb8a5109f17b277b37d7e6b1aaa1 and elements</span></span>
<span><span class="co">#&gt; [1] 7 1 9 5 6 8 4 2 3</span></span>
<span><span class="co">#&gt; (in some order)</span></span>
<span><span class="va">b</span></span>
<span><span class="co">#&gt; A disord object with hash 909ab9cb9afebb8a5109f17b277b37d7e6b1aaa1 and elements</span></span>
<span><span class="co">#&gt; [1] 5 2 8 6 1 4 3 9 7</span></span>
<span><span class="co">#&gt; (in some order)</span></span></code></pre></div>
<p>See how <code>a</code> and <code>b</code> have the same hash code. Then, although the elements of <code>a</code> and <code>b</code> are stored in an implementation-specific (and thus unknown) order, whatever order it is is the same in both objects and they are relatable:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">a</span><span class="op">+</span><span class="va">b</span></span>
<span><span class="co">#&gt; A disord object with hash 909ab9cb9afebb8a5109f17b277b37d7e6b1aaa1 and elements</span></span>
<span><span class="co">#&gt; [1] 12  3 17 11  7 12  7 11 10</span></span>
<span><span class="co">#&gt; (in some order)</span></span>
<span><span class="va">a</span><span class="op">[</span><span class="va">b</span> <span class="op">&lt;</span> <span class="fl">0.5</span><span class="op">]</span></span>
<span><span class="co">#&gt; integer(0)</span></span>
<span><span class="va">a</span><span class="op">[</span><span class="va">b</span> <span class="op">&lt;</span> <span class="fl">0.2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">b</span><span class="op">[</span><span class="va">b</span> <span class="op">&lt;</span> <span class="fl">0.2</span><span class="op">]</span></span>
<span><span class="va">a</span></span>
<span><span class="co">#&gt; A disord object with hash 909ab9cb9afebb8a5109f17b277b37d7e6b1aaa1 and elements</span></span>
<span><span class="co">#&gt; [1] 7 1 9 5 6 8 4 2 3</span></span>
<span><span class="co">#&gt; (in some order)</span></span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="comparison-with-python">Comparison with python<a class="anchor" aria-label="anchor" href="#comparison-with-python"></a>
</h1>
<p>A disord object is comparable with python arrays with the proviso that one is only allowed to access or manipulate elements via list comprehensions. See the following python session:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="sc">~</span> % python3</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>Python <span class="dv">3</span>.<span class="fl">9.5</span> (default, May  <span class="dv">4</span> <span class="dv">2021</span>, <span class="dv">03</span><span class="sc">:</span><span class="dv">33</span><span class="sc">:</span><span class="dv">11</span>) </span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>[Clang <span class="dv">12</span>.<span class="fl">0.0</span> (clang<span class="dv">-1200</span>.<span class="dv">0</span>.<span class="fl">32.29</span>)] on darwin</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>Type <span class="st">"help"</span>, <span class="st">"copyright"</span>, <span class="st">"credits"</span> or <span class="st">"license"</span> <span class="cf">for</span> more information.</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;&gt;</span> from numpy import <span class="sc">*</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="er">&gt;&gt;&gt;</span> a <span class="ot">=</span> <span class="fu">random.rand</span>(<span class="dv">5</span>)</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;&gt;</span> b <span class="ot">=</span> <span class="fu">random.rand</span>(<span class="dv">5</span>)</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;&gt;</span> a</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="fu">array</span>([<span class="fl">0.13275574</span>, <span class="fl">0.07243463</span>, <span class="fl">0.0543058</span> , <span class="fl">0.36633955</span>, <span class="fl">0.73795801</span>])</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;&gt;</span> b</span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a><span class="fu">array</span>([<span class="fl">0.14934221</span>, <span class="fl">0.11321413</span>, <span class="fl">0.6135964</span> , <span class="fl">0.53558058</span>, <span class="fl">0.6396702</span> ])</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;&gt;</span> [i<span class="sc">**</span><span class="dv">2</span> <span class="cf">for</span> i <span class="cf">in</span> a]</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a>[<span class="fl">0.017624086607707354</span>, <span class="fl">0.005246776214236293</span>, <span class="fl">0.002949120389839953</span>, <span class="fl">0.1342046637421116</span>, <span class="fl">0.54458202262916</span>]</span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;&gt;</span> [i<span class="sc">+</span>j <span class="cf">for</span> i,j <span class="cf">in</span> <span class="fu">zip</span>(a,b)]</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>[<span class="fl">0.28209795105056</span>, <span class="fl">0.18564876373593042</span>, <span class="fl">0.6679022004516395</span>, <span class="fl">0.901920128499422</span>, <span class="fl">1.377628206483919</span>]</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;&gt;</span> </span></code></pre></div>
<p>Note that in the last line <code><a href="https://rdrr.io/r/utils/zip.html" class="external-link">zip()</a></code> is used to relate <code>a</code> and <code>b</code> which is accomplished in the package by explicitly setting the hash code.</p>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=disordR" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/RobinHankin/disordR/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/RobinHankin/disordR/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing disordR</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Robin K. S. Hankin <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-5982-0415" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=disordR" class="external-link"><img src="https://www.r-pkg.org/badges/version/disordR" alt="CRAN_Status_Badge"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Robin K. S. Hankin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
